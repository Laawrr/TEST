<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SQL Injection Detector</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
  body {
    font-family: Arial, sans-serif;
    background: #111827;
    color: #e5e7eb;
    display: flex;
    justify-content: center;
    padding: 40px;
  }
  .box {
    width: 100%;
    max-width: 700px;
    background: #1f2937;
    padding: 20px;
    border-radius: 10px;
  }
  h1 { margin: 0 0 15px; }
  pre {
    background: #0f172a;
    padding: 12px;
    border-radius: 6px;
    margin-top: 15px;
    white-space: pre-wrap;
  }
</style>
</head>
<body>

<div class="box">
  <h1>Automatic SQL Injection Detector</h1>
  <p>This page automatically analyzes the <strong>full URL you used to open this page</strong>.</p>

  <h3>URL being analyzed:</h3>
  <pre id="urlBox"></pre>

  <h3>Detection Result:</h3>
  <pre id="resultBox">Analyzing...</pre>
</div>

<script>
  // Your FastAPI SQL Injection detection API
  const API = "https://unavowably-equilibrious-merideth.ngrok-free.dev/predict";

  // Get the FULL URL including path + query + hash
  const fullUrl = window.location.href;

  // Show it on screen
  document.getElementById("urlBox").textContent = fullUrl;

  // Extract everything AFTER domain:
  // https://site.com/some/path?abc=1#hash
  // becomes:
  // /some/path?abc=1#hash
  const parts = window.location.pathname + window.location.search + window.location.hash;

  async function analyze(text) {
    const resultBox = document.getElementById("resultBox");

    try {
      const res = await fetch(API, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ query: text })
      });

      const data = await res.json();
      resultBox.textContent = JSON.stringify(data, null, 2);
    } catch (err) {
      resultBox.textContent = "Error contacting detection API: " + err.message;
    }
  }

  // RUN AUTOMATICALLY
  analyze(parts);
</script>

</body>
</html>
