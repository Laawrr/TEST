<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SQL Injection URL Tester</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
  body {
    font-family: Arial, sans-serif;
    background: #111827;
    color: #e5e7eb;
    display: flex;
    justify-content: center;
    padding: 40px;
  }
  .box {
    width: 100%;
    max-width: 600px;
    background: #1f2937;
    padding: 20px;
    border-radius: 10px;
  }
  input, textarea {
    width: 100%;
    padding: 12px;
    background: #0f172a;
    border: 1px solid #374151;
    border-radius: 6px;
    color: white;
  }
  button {
    margin-top: 12px;
    padding: 10px 18px;
    background: #3b82f6;
    border: none;
    border-radius: 6px;
    color: white;
    cursor: pointer;
  }
  button:hover {
    background: #2563eb;
  }
  pre {
    background: #0f172a;
    padding: 12px;
    border-radius: 6px;
    margin-top: 15px;
    white-space: pre-wrap;
  }
</style>
</head>
<body>

<div class="box">
  <h1>SQL Injection Detector</h1>

  <label>Text Box Test</label>
  <textarea id="inputBox" rows="3" placeholder="Try: admin' OR 1=1 --"></textarea>

  <button onclick="sendManualTest()">Test Text</button>

  <hr style="margin: 20px 0; border-color:#374151" />

  <h2>URL-Based Test (auto)</h2>
  <p>If you visit this page with <code>?q=value</code>, it will automatically test it.</p>

  <pre id="urlDetected">(waiting for URL param...)</pre>

  <hr style="margin: 20px 0; border-color:#374151" />

  <h2>Result</h2>
  <pre id="resultBox">{}</pre>
</div>

<script>
  // Your API
  const API = "https://unavowably-equilibrious-merideth.ngrok-free.dev/predict";

  async function sendToAPI(value) {
    const resultBox = document.getElementById("resultBox");
    resultBox.textContent = "Checking...";

    try {
      const res = await fetch(API, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ query: value })
      });

      const data = await res.json();
      resultBox.textContent = JSON.stringify(data, null, 2);
    } catch (err) {
      resultBox.textContent = "Error: " + err.message;
    }
  }

  async function sendManualTest() {
    const text = document.getElementById("inputBox").value.trim();
    if (!text) {
      document.getElementById("resultBox").textContent = "Please enter something.";
      return;
    }
    sendToAPI(text);
  }

  // ================================
  // AUTO URL TESTING
  // If URL contains ?q=...
  // ================================
  window.onload = function() {
    const params = new URLSearchParams(window.location.search);
    const q = params.get("q");

    const urlBox = document.getElementById("urlDetected");

    if (q) {
      urlBox.textContent = "Detected URL param: ?q=" + q + "\nTesting automatically...";
      sendToAPI(q);
    } else {
      urlBox.textContent = "No ?q= parameter found in URL.";
    }
  };
</script>

</body>
</html>
